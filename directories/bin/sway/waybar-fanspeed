#!/usr/bin/env bash
#Maintained in linux-config.org

f=$(sensors | \grep -i "^fan" | awk '{print $1,$2}' | sed 's/fan//g' | sed 's/: /:/')
readarray -t fans <<< $(echo -e "${f}")
output=""
for fan in "${fans[@]}"; do
    IFS=: read -r fanid rpm <<< "${fan}"
    if [ ! "${rpm}" = "0" ]; then
        output="${output}<span color='orange'>${fanid}:</span><span color='green'>${rpm} </span>"
    fi
done

echo $(jq --null-input --arg text "${output}" '{"text": $text}')
