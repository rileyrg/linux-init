#!/usr/bin/env bash
#Maintained in linux-config.org
cd /sys/class/hwmon
curhwmon=""
while read -r fanfile ; do
    speed=$(cat "${fanfile}")
    if [ ! "${speed}" = "0" ]; then
        hwmon=$(sed 's@^[^0-9]*\([0-9]\+\).*@\1@' <<< "${fanfile}")
        if [ ! "${hwmon}" = "${curhwmon}" ]; then
            curhwmon="${hwmon}"
            thisoutput="hwmon${hwmon}:"
        else
            thisoutput=""
        fi
        f=$(basename "${fanfile}")
        fanid=$(sed 's/[^0-9]//g' <<<  ${f})
        thisoutput="${thisoutput}<span color='orange'>${fanid} </span><span color='green'>${speed} </span>"
        output="${output}${thisoutput}"
    fi
done < <(find -L . -maxdepth 2 -type f -name "fan*input" | sort )

echo "${output:-No Active Fans Read}"
